from keybert import KeyBERT

def get_keybert(lyrics_tokens:list[list[str]], n_gram = (1,1), word_no = 5):
    doc = ' '.join([' '.join(sent) for sent in lyrics_tokens])
    kw_model = KeyBERT('all-mpnet-base-v2')
    keywords = kw_model.extract_keywords(doc, top_n=word_no, keyphrase_ngram_range=n_gram)
    return keywords

if __name__ == '__main__':
    docs = [['lately', 'i', 'have', 'been', 'i', 'have', 'been', 'thinking'], ['i', 'want', 'you', 'to', 'be', 'happier', 'i', 'want', 'you', 'to', 'be', 'happier'], ['when', 'morning', 'comes'], ['when', 'we', 'see', 'what', 'we', 'have', 'become'], ['in', 'cold', 'light', 'of', 'day', 'we', 'are', 'flame', 'in', 'wind'], ['not', 'fire', 'that', 'we', 'have', 'begun'], ['every', 'argument', 'every', 'word', 'we', 'can', 'not', 'take', 'back'], ['cause', 'with', 'all', 'that', 'has', 'happened'], ['i', 'think', 'that', 'we', 'both', 'know', 'way', 'that', 'this', 'story', 'ends'], ['then', 'only', 'for', 'minute'], ['i', 'want', 'to', 'change', 'my', 'mind'], ['cause', 'this', 'just', 'do', 'not', 'feel', 'right', 'to', 'me'], ['i', 'want', 'to', 'raise', 'your', 'spirits'], ['i', 'want', 'to', 'see', 'you', 'smile', 'but'], ['know', 'that', 'means', 'i', 'will', 'have', 'to', 'leave'], ['know', 'that', 'means', 'i', 'will', 'have', 'to', 'leave'], ['lately', 'i', 'have', 'been', 'i', 'have', 'been', 'thinking'], ['i', 'want', 'you', 'to', 'be', 'happier', 'i', 'want', 'you', 'to', 'be', 'happier'], ['you', 'might', 'also', 'like'], ['when', 'evening', 'falls'], ['and', 'i', 'am', 'left', 'there', 'with', 'my', 'thoughts'], ['and', 'image', 'of', 'you', 'being', 'with', 'someone', 'else'], ['well', 'it', 'eating', 'me', 'up', 'inside'], ['but', 'we', 'ran', 'our', 'course', 'we', 'pretended', 'we', 'are', 'okay'], ['now', 'if', 'we', 'jump', 'together', 'at', 'least', 'we', 'can', 'swim'], ['far', 'away', 'from', 'wreck', 'we', 'made'], ['then', 'only', 'for', 'minute'], ['i', 'want', 'to', 'change', 'my', 'mind'], ['cause', 'this', 'just', 'do', 'not', 'feel', 'right', 'to', 'me'], ['i', 'want', 'to', 'raise', 'your', 'spirits'], ['i', 'want', 'to', 'see', 'you', 'smile', 'but'], ['know', 'that', 'means', 'i', 'will', 'have', 'to', 'leave'], ['know', 'that', 'means', 'i', 'will', 'have', 'to', 'leave'], ['lately', 'i', 'have', 'been', 'i', 'have', 'been', 'thinking'], ['i', 'want', 'you', 'to', 'be', 'happier', 'i', 'want', 'you', 'to', 'be', 'happier'], ['so', 'i', 'will', 'go', 'i', 'will', 'go'], ['i', 'will', 'go', 'go', 'go'], ['so', 'i', 'will', 'go', 'i', 'will', 'go'], ['i', 'will', 'go', 'go', 'go'], ['lately', 'i', 'have', 'been', 'i', 'have', 'been', 'thinking'], ['i', 'want', 'you', 'to', 'be', 'happier', 'i', 'want', 'you', 'to', 'be', 'happier'], ['even', 'though', 'i', 'might', 'not', 'like', 'this'], ['i', 'think', 'that', 'you', 'will', 'be', 'happier', 'i', 'want', 'you', 'to', 'be', 'happier'], ['then', 'only', 'for', 'minute', 'only', 'for', 'minute'], ['i', 'want', 'to', 'change', 'my', 'mind'], ['cause', 'this', 'just', 'do', 'not', 'feel', 'right', 'to', 'me', 'right', 'to', 'me'], ['i', 'want', 'to', 'raise', 'your', 'spirits', 'wan', 'na', 'raise', 'your', 'spirits'], ['i', 'want', 'to', 'see', 'you', 'smile', 'but'], ['know', 'that', 'means', 'i', 'will', 'have', 'to', 'leave'], ['know', 'that', 'means', 'i', 'will', 'have', 'to', 'leave'], ['lately', 'i', 'have', 'been', 'i', 'have', 'been', 'thinking'], ['i', 'want', 'you', 'to', 'be', 'happier', 'i', 'want', 'you', 'to', 'be', 'happier'], ['so', 'i', 'will', 'go', 'i', 'will', 'go'], ['i', 'will', 'go', 'go', 'go']]
    print(get_keybert(docs))
